@TTL |GbaHelloWorld|
@AREA |Program| @CODE, @READWRITE
@ENTRY

    ramarea     @EQU    0x02000000
    cursor_x    @EQU    0x02000020
    cursor_y    @EQU    0x02000021
    
    @ORG 0x08000000

    ;need 122 16bit entries to match GBA header
    ;already little endian, no need to flip
    ;++++++++++++++++++++++++++++++++
    ;$FLPINCBIN |C:\Users\variable\Documents\GitHub\GenAsm\cfg\THUMB\INCBIN\gba_header.bin|
    ;++++++++++++++++++++++++++++++++

    ;already little endian, no need to flip
    ;++++++++++++++++++++++++++++++++
    ;$FLPINCBIN |C:\Users\variable\Documents\GitHub\GenAsm\cfg\THUMB\INCBIN\gba_arm2thumb_jump_addr_00F4.bin|
    ;++++++++++++++++++++++++++++++++
    
    ;.thumb				;Thumb mode
    program_start                       ;Init Stack Pointer. Arm 2 thumb entry point 0x00F4
    LDR     R1, [PC, `stack_pointer]
    ;$NOP
    LDR     R2, [PC, `disp_control]
    ;$NOP
    LDR     R4, [PC, `screen_mode]      ;4 = Layer 2 on / 3 = ScreenMode 3

    ;$NOP
    MOV     R8, R1
    MOV     R5, R8
    MOV     SP, R5
    STR     R2, [R4, #0]

    LDR     R1, [PC, `hello_world]

    loop
    B       `loop
@END

@AREA |Data| @DATA, @READWRITE
@ENTRY

    stack_pointer   @DCHW   0x0000
                    @DCHW   0x0300
    disp_control    @DCHW   0x0000
                    @DCHW   0x0400
    screen_mode     @DCHW   0x0403
                    @DCHW   0x0000
    hello_world     
                    ;$FLIPSTRING |Hello World|
@END
